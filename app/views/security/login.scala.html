@(loginForm: Form[(String,String)], errorMsg: Option[String] = None)(implicit request: RequestHeader)

@import helper._
@import securesocial.core.Registry
@import securesocial.core.AuthenticationMethod._
@import securesocial.core.providers.UsernamePasswordProvider.UsernamePassword

@main(Messages("securesocial.login.title")) {
<div class="top_bg">
    <div class="wrap">
        <div class="main_top">
            <h2 class="style">@Messages("securesocial.login.title")</h2>
        </div>
    </div>
</div>
<div class="main_bg">
    <div class="wrap">
        @errorMsg.map { msg =>
            <div class="alert alert-error">
                @Messages(msg)
            </div>
        }

        @request.flash.get("success").map { msg =>
            <div class="alert alert-info">
                @msg
            </div>
        }

        @request.flash.get("error").map { msg =>
            <div class="alert alert-error">
                @msg
            </div>
        }
        <div class="main">
            @defining( Registry.providers.all.values.filter( _.id != UsernamePassword) ) { externalProviders =>

                @if( externalProviders.size > 0 ) {
                    <div class="top_main">
                        <h2>@Messages("securesocial.login.instructions")</h2>
                        <div class="clear"></div>
                    </div>
                    <div class="clearfix">
                        <p>
                            @for(p <- externalProviders) {
                                @securesocial.views.html.provider(p.id)
                            }
                        </p>
                    </div>
                }

                @Registry.providers.get(UsernamePassword).map { up =>
                    <div class="clearfix">
                        @if( externalProviders.size > 0 ) {
                            <p>@Messages("securesocial.login.useEmailAndPassword")</p>
                        } else {
                            <p>@Messages("securesocial.login.useEmailAndPasswordOnly")</p>
                        }

                        @securesocial.views.html.provider("userpass", Some(loginForm))
                    </div>
                }
            }
        </div>
    </div>
</div>
<script type="text/javascript" src="@controllers.routes.Assets.at("javascripts/views/product/catalog.js")"></script>
}
